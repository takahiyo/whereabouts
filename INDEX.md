# AIコーディングマニュアル

本マニュアルは、AIによるコーディング作業において、コードの品質と安全性を確保するためのガイドライン集である。

---

## 本マニュアルの目的

AIコーディングにおいて以下を実現する：

1. **SSOT（Single Source of Truth）の徹底** - 定数の重複を防ぎ、保守性を確保
2. **モジュール化とコメントの完備** - 機能追加や分割時の破壊を防止
3. **ガイドラインの整備** - 以降の開発をスムーズに行うための基盤

---

## ドキュメント構成

### 必読（常時参照）

| ドキュメント | 内容 | 読むタイミング |
|--------------|------|----------------|
| [CORE_PRINCIPLES.md](./CORE_PRINCIPLES.md) | **基本原則（最重要）** | 作業開始時に必ず読む |

### 作業別ガイド

| ドキュメント | 内容 | 参照タイミング |
|--------------|------|----------------|
| [SSOT_GUIDE.md](./SSOT_GUIDE.md) | 定数管理・SSOT実践 | 定数・設定値を追加するとき |
| [MODULE_GUIDE.md](./MODULE_GUIDE.md) | モジュール化・依存注入 | 新機能を追加するとき |
| [COMMENT_GUIDE.md](./COMMENT_GUIDE.md) | コメント・ドキュメント規約 | コードを書くとき（常時） |
| [REFACTOR_GUIDE.md](./REFACTOR_GUIDE.md) | 分割・リファクタリング全般 | コードを分割・整理するとき |
| [CSS_GUIDE.md](./CSS_GUIDE.md) | CSS分割の詳細規則 | CSSを分割・改修するとき |

---

## AIへの指示方法（ユーザー向け）

### 新しい開発セッションを開始するとき

以下のように指示する：

```
まず CORE_PRINCIPLES.md を読んでください。
その後、このプロジェクトの構造を確認し、既存パターンを把握してから作業を開始してください。
```

### 特定の作業を依頼するとき

```
# 定数追加の場合
SSOT_GUIDE.md に従って、新しい定数を追加してください。

# 新機能追加の場合
MODULE_GUIDE.md に従って、既存の依存注入パターンを維持しながら実装してください。

# コード分割の場合
REFACTOR_GUIDE.md に従って、フェーズごとに作業を進めてください。
まずフェーズ1（参照元調査）を完了してから、次に進んでください。

# CSS分割の場合
CSS_GUIDE.md に従って、参照元調査を完了してから分割を進めてください。
```

### ルール遵守を確認するとき

```
作業完了後、CORE_PRINCIPLES.md の「禁止事項チェックリスト」を確認してください。
```

---

## 運用フロー

### 開発作業の標準フロー

```
1. CORE_PRINCIPLES.md を読む
       ↓
2. プロジェクト構造を確認
   - README.md（プロジェクト説明）
   - 既存コードのパターン
       ↓
3. 作業内容に応じたガイドを参照
   - 定数追加 → SSOT_GUIDE.md
   - 機能追加 → MODULE_GUIDE.md
   - 分割作業 → REFACTOR_GUIDE.md
   - CSS分割 → CSS_GUIDE.md
       ↓
4. 実装
   - COMMENT_GUIDE.md に従ってコメント付与
   - 既存パターンに従う
       ↓
5. 検証
   - 禁止事項チェックリストを確認
   - 動作確認
       ↓
6. 必要に応じてドキュメント更新
   - 機能マップの更新
   - 変更履歴の記録
```

### 新規ガイドラインの作成基準

以下の場合、新しいガイドラインドキュメントを作成する：

| 状況 | 作成するドキュメント |
|------|----------------------|
| 新しい技術領域の追加 | `XXXX_GUIDE.md`（ルートに追加） |
| 複雑なモジュールの追加 | `docs/モジュール名-map.md` |
| プロジェクト固有の規則 | `docs/` に配置 |

---

## ガイドラインの優先順位

ガイドライン間で矛盾が生じた場合、以下の優先順位に従う：

1. **CORE_PRINCIPLES.md**（最優先）
2. プロジェクト固有のガイドライン
3. 各詳細ガイド（SSOT_GUIDE等）

---

## マニュアル更新の方針

### 更新が必要な場合

- 新しいパターンが確立されたとき
- 既存ルールで問題が発生したとき
- 対象技術領域が増えたとき

### 更新手順

1. 変更内容を明確化
2. 該当ドキュメントを更新
3. INDEX.md の更新（構成が変わった場合）
4. 変更理由をコミットメッセージに記録

---

## クイックリファレンス

### 絶対禁止事項（CORE_PRINCIPLES より）

- ❌ 定数をコード内に直接記述
- ❌ 既存のモジュール構造・初期化順序を破壊
- ❌ コメントなしでコードを追加
- ❌ 影響範囲を確認せずにコード変更

### 常に行うこと

- ✅ 定数は `constants/` に集約
- ✅ 新規関数にはJSDocコメント
- ✅ 依存注入パターンの維持
- ✅ 変更前に参照元を確認

### 分割作業時の必須フェーズ

1. 参照元調査（編集禁止）
2. 参照元コメント付記
3. 分割計画確定
4. 物理分割（内容変更禁止）
5. インポートパス更新
6. 検証
